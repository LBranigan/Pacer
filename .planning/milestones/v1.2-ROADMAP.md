# Milestone v1.2: VAD Gap Analysis

**Status:** SHIPPED 2026-02-04
**Phases:** 18-19
**Total Plans:** 3

## Overview

VAD-based acoustic analysis for pause/gap indicators, giving teachers visibility into what actually happened during reported "silences" — distinguishing true hesitation from sounding out or timestamp drift.

## Phases

### Phase 18: VAD Gap Analyzer Core

**Goal:** System can analyze VAD speech activity within any time range and enrich diagnostics with acoustic context.

**Dependencies:** v1.1 VAD infrastructure (vad.js, vadCalibration.js)

**Plans:** 2 plans

- [x] 18-01: Create VAD gap analyzer module with core functions
- [x] 18-02: Integrate into app.js pipeline with debug logging

**Details:**

Created `js/vad-gap-analyzer.js` with 5 exports:
- `ACOUSTIC_LABELS` — 5-tier classification constants
- `calculateSpeechPercent()` — VAD segment overlap for any time range
- `getAcousticLabel()` — Percentage to human-readable label
- `enrichDiagnosticsWithVAD()` — Mutate diagnostics with `_vadAnalysis`
- `computeVADGapSummary()` — Debug logging support

Key decisions:
- <10% threshold for "silence confirmed" (strict interpretation)
- Mutation pattern with _vadAnalysis matches codebase conventions
- Guard with vadResult.segments check for VAD unavailable cases

---

### Phase 19: VAD Gap UI Display

**Goal:** Teachers can see VAD acoustic context when reviewing pause and hesitation indicators.

**Dependencies:** Phase 18 (VAD gap analyzer must enrich diagnostics first)

**Plans:** 1 plan

- [x] 19-01: Add VAD tooltips and visual distinction to pause/hesitation indicators

**Details:**

- Added `buildVADTooltipInfo()` helper to ui.js
- Pause indicators show "VAD: X% (label) - hint" on hover
- Hesitation indicators show "VAD: X% (label) - hint" on hover
- Pauses with VAD >= 30% display in orange (#ff9800) instead of gray
- Hesitations with VAD >= 30% have orange left border

---

## Milestone Summary

**Decimal Phases:** None

**Key Decisions:**

- Used <10% threshold for silence confirmed (strict interpretation)
- Round speech percentage to one decimal place for clean display
- Mutation pattern with _vadAnalysis matches existing codebase conventions
- Place VAD enrichment after diagnostics, before self-correction processing
- Guard with vadResult.segments check to handle VAD unavailable cases
- Tooltip format "VAD: X% (label) - hint" per user decision

**Issues Resolved:**

- Teachers can now distinguish true silence from gaps containing speech activity
- Sounding-out behavior no longer misclassified as hesitation

**Issues Deferred:**

- Differentiated struggle classification ("Hesitation" vs "Sounding out" as separate categories)
- Teacher dashboard aggregation of VAD analysis across students
- Threshold tuning UI for "significant" activity threshold

**Technical Debt Incurred:**

None identified.

---

*For current project status, see .planning/ROADMAP.md*
*Archived: 2026-02-04*
