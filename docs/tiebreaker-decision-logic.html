<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cross-Validation Tiebreaker Decision Logic</title>
<style>
  :root {
    --bg: #0f172a;
    --surface: #1e293b;
    --surface2: #334155;
    --border: #475569;
    --text: #e2e8f0;
    --text-dim: #94a3b8;
    --green: #22c55e;
    --green-dim: #166534;
    --red: #ef4444;
    --red-dim: #991b1b;
    --yellow: #eab308;
    --yellow-dim: #854d0e;
    --blue: #3b82f6;
    --blue-dim: #1e40af;
    --purple: #a855f7;
    --purple-dim: #6b21a8;
    --orange: #f97316;
    --cyan: #06b6d4;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.6;
    padding: 2rem;
    min-height: 100vh;
  }

  h1 {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 0.25rem;
    color: #fff;
  }

  .subtitle {
    color: var(--text-dim);
    font-size: 0.875rem;
    margin-bottom: 2rem;
  }

  /* ── Layout ── */
  .container {
    max-width: 1200px;
    margin: 0 auto;
  }

  .grid-2 {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
    margin-bottom: 1.5rem;
  }

  .grid-3 {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 1.5rem;
    margin-bottom: 1.5rem;
  }

  @media (max-width: 900px) {
    .grid-2, .grid-3 { grid-template-columns: 1fr; }
  }

  /* ── Cards ── */
  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 1.25rem;
  }

  .card h2 {
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--text-dim);
    margin-bottom: 0.75rem;
    font-weight: 600;
  }

  .card h3 {
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
  }

  .full-width { grid-column: 1 / -1; }

  /* ── Flow diagram ── */
  .flow {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0;
  }

  .flow-node {
    background: var(--surface2);
    border: 2px solid var(--border);
    border-radius: 10px;
    padding: 0.75rem 1.25rem;
    text-align: center;
    max-width: 420px;
    width: 100%;
    position: relative;
  }

  .flow-node.start {
    border-color: var(--blue);
    background: rgba(59, 130, 246, 0.1);
  }

  .flow-node.decision {
    border-color: var(--yellow);
    background: rgba(234, 179, 8, 0.08);
    transform: rotate(0deg);
    border-radius: 4px;
    clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
    padding: 2rem 2.5rem;
    min-height: 100px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .flow-node.action-green {
    border-color: var(--green);
    background: rgba(34, 197, 94, 0.1);
  }

  .flow-node.action-red {
    border-color: var(--red);
    background: rgba(239, 68, 68, 0.1);
  }

  .flow-node.action-yellow {
    border-color: var(--yellow);
    background: rgba(234, 179, 8, 0.1);
  }

  .flow-node.action-purple {
    border-color: var(--purple);
    background: rgba(168, 85, 247, 0.1);
  }

  .flow-arrow {
    width: 2px;
    height: 24px;
    background: var(--border);
    position: relative;
  }

  .flow-arrow::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    border-left: 5px solid transparent;
    border-right: 5px solid transparent;
    border-top: 6px solid var(--border);
  }

  .flow-arrow-label {
    font-size: 0.7rem;
    color: var(--text-dim);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    padding: 2px 8px;
    margin: -4px 0;
  }

  .flow-branch {
    display: flex;
    gap: 1rem;
    width: 100%;
    justify-content: center;
    align-items: flex-start;
  }

  .flow-branch-col {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 1;
    max-width: 280px;
    gap: 0;
  }

  /* ── Decision tree (CSS-only) ── */
  .tree {
    width: 100%;
  }

  .tree-level {
    display: flex;
    justify-content: center;
    position: relative;
    margin-bottom: 0.5rem;
  }

  .tree-node {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 0.6rem 1rem;
    font-size: 0.8rem;
    text-align: center;
    position: relative;
  }

  .tree-node.q {
    border-color: var(--yellow);
    background: rgba(234, 179, 8, 0.08);
    font-weight: 600;
  }

  .tree-node.yes {
    border-color: var(--green);
    background: rgba(34, 197, 94, 0.08);
  }

  .tree-node.no {
    border-color: var(--red);
    background: rgba(239, 68, 68, 0.08);
  }

  .tree-node.neutral {
    border-color: var(--blue);
    background: rgba(59, 130, 246, 0.08);
  }

  /* ── Tags / badges ── */
  .tag {
    display: inline-block;
    padding: 0.15rem 0.5rem;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.04em;
  }

  .tag-green { background: var(--green-dim); color: var(--green); }
  .tag-red { background: var(--red-dim); color: var(--red); }
  .tag-yellow { background: var(--yellow-dim); color: var(--yellow); }
  .tag-blue { background: var(--blue-dim); color: var(--blue); }
  .tag-purple { background: var(--purple-dim); color: var(--purple); }

  /* ── Scenario table ── */
  .scenario-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.8rem;
  }

  .scenario-table th {
    text-align: left;
    padding: 0.5rem;
    border-bottom: 2px solid var(--border);
    color: var(--text-dim);
    font-size: 0.7rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .scenario-table td {
    padding: 0.5rem;
    border-bottom: 1px solid var(--surface2);
    vertical-align: top;
  }

  .scenario-table tr:last-child td { border-bottom: none; }

  /* ── Engine comparison ── */
  .engine-card {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .engine-name {
    font-size: 1rem;
    font-weight: 700;
  }

  .engine-detail {
    font-size: 0.78rem;
    color: var(--text-dim);
  }

  .engine-detail strong {
    color: var(--text);
  }

  .bias-list {
    list-style: none;
    padding: 0;
  }

  .bias-list li {
    font-size: 0.78rem;
    padding: 0.3rem 0;
    border-bottom: 1px solid rgba(255,255,255,0.05);
    display: flex;
    align-items: flex-start;
    gap: 0.4rem;
  }

  .bias-list li:last-child { border-bottom: none; }

  .bias-icon {
    flex-shrink: 0;
    width: 16px;
    text-align: center;
  }

  /* ── Stats bar ── */
  .stat-row {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.5rem;
  }

  .stat-label {
    font-size: 0.75rem;
    color: var(--text-dim);
    min-width: 140px;
  }

  .stat-bar {
    flex: 1;
    height: 8px;
    background: var(--surface2);
    border-radius: 4px;
    overflow: hidden;
  }

  .stat-fill {
    height: 100%;
    border-radius: 4px;
    transition: width 0.3s;
  }

  .stat-value {
    font-size: 0.75rem;
    font-weight: 600;
    min-width: 50px;
    text-align: right;
  }

  /* ── Decision tree visual ── */
  .dtree {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1rem 0;
  }

  .dtree-row {
    display: flex;
    justify-content: center;
    gap: 1rem;
    width: 100%;
    margin-bottom: 0.25rem;
  }

  .dtree-connector {
    display: flex;
    justify-content: center;
    width: 100%;
    height: 24px;
    position: relative;
  }

  .dtree-line-v {
    width: 2px;
    background: var(--border);
    height: 100%;
  }

  .dtree-box {
    background: var(--surface2);
    border: 1.5px solid var(--border);
    border-radius: 8px;
    padding: 0.5rem 0.75rem;
    font-size: 0.78rem;
    text-align: center;
    min-width: 140px;
  }

  .dtree-box.question {
    border-color: var(--yellow);
    background: rgba(234, 179, 8, 0.06);
    font-weight: 600;
  }

  .dtree-box.outcome-correct {
    border-color: var(--green);
    background: rgba(34, 197, 94, 0.08);
  }

  .dtree-box.outcome-error {
    border-color: var(--red);
    background: rgba(239, 68, 68, 0.08);
  }

  .dtree-box.outcome-keep {
    border-color: var(--blue);
    background: rgba(59, 130, 246, 0.08);
  }

  .dtree-box.outcome-disable {
    border-color: var(--purple);
    background: rgba(168, 85, 247, 0.08);
  }

  .dtree-label {
    font-size: 0.65rem;
    color: var(--text-dim);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.04em;
    margin: 2px 0;
  }

  .dtree-split {
    display: flex;
    justify-content: center;
    width: 100%;
    gap: 0;
    position: relative;
  }

  .dtree-split-col {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    max-width: 220px;
  }

  /* ── Horizontal connector lines ── */
  .h-connector {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 24px;
    width: 100%;
    position: relative;
  }

  .h-connector::before {
    content: '';
    position: absolute;
    top: 0;
    left: 25%;
    right: 25%;
    height: 2px;
    background: var(--border);
  }

  .h-connector .left-drop,
  .h-connector .right-drop {
    position: absolute;
    top: 0;
    width: 2px;
    height: 100%;
    background: var(--border);
  }

  .h-connector .left-drop { left: 25%; }
  .h-connector .right-drop { right: 25%; }

  /* ── Full decision flowchart ── */
  .flowchart {
    width: 100%;
    overflow-x: auto;
    padding: 1rem 0;
  }

  .fc-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    min-width: 700px;
  }

  .fc-node {
    padding: 0.6rem 1.2rem;
    border-radius: 8px;
    font-size: 0.8rem;
    text-align: center;
    font-weight: 500;
    border: 2px solid;
    max-width: 340px;
  }

  .fc-input { border-color: var(--blue); background: rgba(59,130,246,0.1); }
  .fc-check { border-color: var(--yellow); background: rgba(234,179,8,0.08); font-weight: 600; }
  .fc-action-g { border-color: var(--green); background: rgba(34,197,94,0.1); }
  .fc-action-r { border-color: var(--red); background: rgba(239,68,68,0.1); }
  .fc-action-b { border-color: var(--blue); background: rgba(59,130,246,0.1); }
  .fc-action-p { border-color: var(--purple); background: rgba(168,85,247,0.1); }

  .fc-v-line {
    width: 2px; height: 20px; background: var(--border);
  }

  .fc-arrow-down {
    width: 0; height: 0;
    border-left: 5px solid transparent;
    border-right: 5px solid transparent;
    border-top: 6px solid var(--border);
  }

  .fc-label {
    font-size: 0.65rem;
    color: var(--text-dim);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .fc-split-row {
    display: flex;
    gap: 2rem;
    width: 100%;
    justify-content: center;
  }

  .fc-split-col {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 1;
    max-width: 300px;
  }

  .fc-h-connector {
    position: relative;
    width: 100%;
    height: 20px;
  }

  .fc-h-connector::before {
    content: '';
    position: absolute;
    top: 0;
    left: calc(50% - 170px);
    right: calc(50% - 170px);
    height: 2px;
    background: var(--border);
  }

  .fc-h-connector .fc-drop-left,
  .fc-h-connector .fc-drop-right {
    position: absolute;
    top: 0;
    width: 2px;
    height: 100%;
    background: var(--border);
  }

  .fc-h-connector .fc-drop-left { left: calc(50% - 170px); }
  .fc-h-connector .fc-drop-right { right: calc(50% - 170px); }

  .fc-inner-split {
    display: flex;
    gap: 1rem;
    width: 100%;
    justify-content: center;
  }

  .fc-inner-col {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 1;
  }

  /* ── Prob meter ── */
  .prob-meter {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.75rem;
    margin-top: 0.25rem;
  }

  .prob-bar {
    width: 60px;
    height: 6px;
    background: var(--surface);
    border-radius: 3px;
    overflow: hidden;
  }

  .prob-fill {
    height: 100%;
    border-radius: 3px;
  }

  /* ── Sections ── */
  .section-header {
    font-size: 0.9rem;
    font-weight: 700;
    color: #fff;
    margin: 2rem 0 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .section-num {
    background: var(--blue);
    color: #fff;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.7rem;
    font-weight: 700;
  }

  /* ── Note callout ── */
  .note {
    background: rgba(234, 179, 8, 0.08);
    border-left: 3px solid var(--yellow);
    padding: 0.75rem 1rem;
    font-size: 0.8rem;
    border-radius: 0 6px 6px 0;
    margin-top: 0.75rem;
  }

  .note-danger {
    background: rgba(239, 68, 68, 0.08);
    border-left-color: var(--red);
  }

  .note-info {
    background: rgba(59, 130, 246, 0.08);
    border-left-color: var(--blue);
  }

  /* ── Comparison bars ── */
  .cmp {
    display: flex;
    align-items: center;
    margin-bottom: 0.4rem;
  }

  .cmp-label {
    font-size: 0.7rem;
    width: 100px;
    color: var(--text-dim);
  }

  .cmp-bars {
    flex: 1;
    display: flex;
    gap: 2px;
  }

  .cmp-bar {
    height: 14px;
    border-radius: 2px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.6rem;
    font-weight: 600;
    color: #fff;
  }

  .example-box {
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 0.75rem;
    margin-top: 0.5rem;
    font-size: 0.78rem;
  }

  .example-label {
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--text-dim);
    font-weight: 600;
    margin-bottom: 0.35rem;
  }

  .word-ref { color: var(--green); font-weight: 600; }
  .word-err { color: var(--red); font-weight: 600; text-decoration: line-through; }
  .word-match { color: var(--cyan); font-weight: 600; }
  .word-dim { color: var(--text-dim); }
  .arrow-r { color: var(--yellow); }
</style>
</head>
<body>
<div class="container">

  <h1>Cross-Validation Tiebreaker: Decision Logic</h1>
  <p class="subtitle">How the system decides which ASR engine to trust when Reverb and Parakeet disagree</p>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- SECTION 1: Engine Comparison -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <div class="section-header"><span class="section-num">1</span> The Two Engines</div>

  <div class="grid-2">
    <div class="card">
      <h2>Primary Engine</h2>
      <div class="engine-card">
        <div class="engine-name" style="color:var(--blue)">Reverb <span class="tag tag-blue">CTC + Attention</span></div>
        <div class="engine-detail"><strong>600M params</strong> &middot; 200K hrs human-transcribed &middot; v=1.0 verbatim mode</div>
        <div class="engine-detail"><strong>Decoder:</strong> 18 conformer encoder + 6-layer bidirectional transformer decoder</div>
        <div class="engine-detail"><strong>LM Strength:</strong> Strong (6-layer transformer acts as conditional LM during rescoring)</div>
        <ul class="bias-list">
          <li><span class="bias-icon" style="color:var(--red)">!</span> BPE mangling: merges/garbles rare word sequences ("wigglewigle")</li>
          <li><span class="bias-icon" style="color:var(--red)">!</span> Maps partial attempts to short real words ("str-" &rarr; "stir")</li>
          <li><span class="bias-icon" style="color:var(--red)">!</span> CTC blank-collapsing loses repetitions ("th- th- the" &rarr; "the")</li>
          <li><span class="bias-icon" style="color:var(--green)">+</span> Verbatim mode preserves filled pauses &amp; stutters</li>
          <li><span class="bias-icon" style="color:var(--green)">+</span> Runs locally &mdash; full control over parameters</li>
        </ul>
      </div>
    </div>

    <div class="card">
      <h2>Cross-Validator Engine</h2>
      <div class="engine-card">
        <div class="engine-name" style="color:var(--purple)">Parakeet TDT <span class="tag tag-purple">Transducer</span></div>
        <div class="engine-detail"><strong>600M params</strong> &middot; 10K human + 110K pseudo-labeled (Whisper-generated)</div>
        <div class="engine-detail"><strong>Decoder:</strong> FastConformer encoder + 2-layer LSTM + TDT duration head</div>
        <div class="engine-detail"><strong>LM Strength:</strong> Moderate (2-layer LSTM + Whisper-inherited fluency bias)</div>
        <ul class="bias-list">
          <li><span class="bias-icon" style="color:var(--red)">!</span> Disfluency deletion: smooths hesitations &amp; partial attempts</li>
          <li><span class="bias-icon" style="color:var(--red)">!</span> "Garbage in, fluent out" &mdash; always produces real words</li>
          <li><span class="bias-icon" style="color:var(--red)">!</span> NVIDIA caveat: "not recommended for word-for-word transcription"</li>
          <li><span class="bias-icon" style="color:var(--red)">!</span> TDT frame-skipping may miss slow/hesitant speech</li>
          <li><span class="bias-icon" style="color:var(--green)">+</span> Different error profile from Reverb (provides diversity)</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="card" style="margin-bottom:1.5rem">
    <h2>Why Two Engines?</h2>
    <p style="font-size:0.82rem; margin-bottom:0.75rem">
      Neither engine was trained on children's speech. Both autocorrect &mdash; but <em>differently</em>.
      CTC+Attention tends toward <strong>BPE mangling</strong> (garbled merges of rare words).
      Transducers tend toward <strong>fluent wrong continuations</strong> (plausible but incorrect words).
      When they <strong>disagree</strong>, that disagreement is a signal of uncertainty &mdash; and the known reference text can break the tie.
    </p>
    <div class="note note-info">
      <strong>Key principle:</strong> Neither engine sees the reference text during decoding.
      Their transcriptions are fully independent. The reference is consulted only
      <em>after</em> both produce their outputs, and only when they disagree.
      This is more conservative than "prompted Whisper" approaches (Apple 2025, Gao et al. 2025)
      that feed the reference directly into the decoder.
    </div>
  </div>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- SECTION 2: The Full Decision Flowchart -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <div class="section-header"><span class="section-num">2</span> Complete Decision Flowchart</div>

  <div class="card full-width">
    <div class="flowchart">
      <div class="fc-container">

        <!-- Input -->
        <div class="fc-node fc-input">For each word: Reverb says <strong>"W<sub>R</sub>"</strong>, Parakeet says <strong>"W<sub>P</sub>"</strong></div>
        <div class="fc-v-line"></div>
        <div class="fc-arrow-down"></div>

        <!-- Check 1: Agreement -->
        <div class="fc-node fc-check">Do the engines agree?<br><span style="font-size:0.7rem;color:var(--text-dim)">exact match, fuzzy &ge;0.8, or edit distance &le;1</span></div>

        <!-- Split: Yes/No -->
        <div class="fc-h-connector">
          <div class="fc-drop-left"></div>
          <div class="fc-drop-right"></div>
        </div>

        <div class="fc-split-row">
          <!-- LEFT: Agree -->
          <div class="fc-split-col">
            <div class="fc-label" style="color:var(--green)">Yes &mdash; Engines Agree</div>
            <div class="fc-v-line"></div>
            <div class="fc-node fc-action-g">
              Status: <strong>confirmed</strong><br>
              <span style="font-size:0.75rem">Trust consensus word. No tiebreaker needed.</span>
              <div class="prob-meter">
                <span>P(correct):</span>
                <div class="prob-bar"><div class="prob-fill" style="width:95%;background:var(--green)"></div></div>
                <span style="color:var(--green)">~95%</span>
              </div>
            </div>

            <div style="height:12px"></div>
            <div class="fc-node fc-check" style="font-size:0.75rem">Does consensus<br>match reference?</div>
            <div style="display:flex;gap:2rem;margin-top:8px">
              <div style="text-align:center">
                <div class="fc-label" style="color:var(--green)">Yes</div>
                <div class="fc-node fc-action-g" style="font-size:0.72rem;padding:0.4rem 0.6rem">
                  <span class="tag tag-green">correct</span><br>Both engines + reference agree
                </div>
              </div>
              <div style="text-align:center">
                <div class="fc-label" style="color:var(--red)">No</div>
                <div class="fc-node fc-action-r" style="font-size:0.72rem;padding:0.4rem 0.6rem">
                  <span class="tag tag-red">substitution</span><br>Strong evidence of real error
                </div>
              </div>
            </div>
          </div>

          <!-- RIGHT: Disagree -->
          <div class="fc-split-col">
            <div class="fc-label" style="color:var(--red)">No &mdash; Engines Disagree</div>
            <div class="fc-v-line"></div>
            <div class="fc-node fc-check" style="font-size:0.78rem">
              Is the adaptive threshold<br>still active?
              <div style="font-size:0.68rem;color:var(--text-dim);margin-top:2px">
                (confirmed error rate &lt; 20%)
              </div>
            </div>

            <div style="display:flex;gap:1.5rem;margin-top:8px;width:100%">
              <!-- Threshold DISABLED -->
              <div style="text-align:center;flex:1">
                <div class="fc-label" style="color:var(--red)">Disabled (&gt;20% errors)</div>
                <div class="fc-v-line" style="margin:0 auto"></div>
                <div class="fc-node fc-action-p" style="font-size:0.72rem;padding:0.4rem">
                  Keep Reverb's word<br>
                  <span style="font-size:0.65rem;color:var(--text-dim)">Tiebreaker bypassed for safety</span>
                </div>
              </div>

              <!-- Threshold ACTIVE -->
              <div style="text-align:center;flex:1.5">
                <div class="fc-label" style="color:var(--green)">Active (&lt;20% errors)</div>
                <div class="fc-v-line" style="margin:0 auto"></div>
                <div class="fc-node fc-check" style="font-size:0.75rem;padding:0.5rem">
                  Which engine(s)<br>match reference?
                </div>

                <div style="display:flex;gap:0.5rem;margin-top:8px;width:100%">
                  <div style="text-align:center;flex:1">
                    <div class="fc-label" style="color:var(--purple);font-size:0.6rem">Only Parakeet</div>
                    <div class="fc-node fc-action-g" style="font-size:0.68rem;padding:0.3rem 0.4rem">
                      <span class="tag tag-green" style="font-size:0.6rem">trust parakeet</span><br>
                      Override Reverb's word
                    </div>
                  </div>
                  <div style="text-align:center;flex:1">
                    <div class="fc-label" style="color:var(--blue);font-size:0.6rem">Only Reverb</div>
                    <div class="fc-node fc-action-b" style="font-size:0.68rem;padding:0.3rem 0.4rem">
                      <span class="tag tag-blue" style="font-size:0.6rem">keep reverb</span><br>
                      Already correct engine
                    </div>
                  </div>
                  <div style="text-align:center;flex:1">
                    <div class="fc-label" style="color:var(--text-dim);font-size:0.6rem">Neither/Both</div>
                    <div class="fc-node fc-action-r" style="font-size:0.68rem;padding:0.3rem 0.4rem">
                      <span class="tag tag-red" style="font-size:0.6rem">keep reverb</span><br>
                      No clear winner
                    </div>
                  </div>
                </div>

              </div>
            </div>

          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- SECTION 3: The 5 Scenarios -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <div class="section-header"><span class="section-num">3</span> All Possible Scenarios with Examples</div>

  <div class="card full-width">
    <table class="scenario-table">
      <thead>
        <tr>
          <th style="width:30px">#</th>
          <th>Scenario</th>
          <th>Reference</th>
          <th>Reverb</th>
          <th>Parakeet</th>
          <th>Decision</th>
          <th>Risk</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><span class="tag tag-green">1</span></td>
          <td><strong>Both agree, match ref</strong></td>
          <td class="word-ref">wiggle</td>
          <td class="word-match">wiggle</td>
          <td class="word-match">wiggle</td>
          <td><span class="tag tag-green">correct</span><br>Confirmed by consensus</td>
          <td style="font-size:0.72rem;color:var(--text-dim)">Minimal. Both could autocorrect same error &rarr; false negative. ~2-5% risk.</td>
        </tr>
        <tr>
          <td><span class="tag tag-red">2</span></td>
          <td><strong>Both agree, NOT ref</strong></td>
          <td class="word-ref">wiggle</td>
          <td class="word-err">weasel</td>
          <td class="word-err">weasel</td>
          <td><span class="tag tag-red">substitution</span><br>Strong substitution signal</td>
          <td style="font-size:0.72rem;color:var(--text-dim)">Could be correlated autocorrect. Both LMs prefer "weasel" over disfluent input. ~8-15% chance student was correct.</td>
        </tr>
        <tr style="background:rgba(34,197,94,0.04)">
          <td><span class="tag tag-green">3</span></td>
          <td><strong>Disagree: Parakeet matches ref</strong><br><em>TIEBREAKER FIRES</em></td>
          <td class="word-ref">wiggle</td>
          <td class="word-err">wigglewigle</td>
          <td class="word-match">wiggle</td>
          <td><span class="tag tag-green">trust parakeet</span><br>Override Reverb</td>
          <td style="font-size:0.72rem;color:var(--yellow)"><strong>~15-20% risk</strong> Parakeet may have autocorrected a genuine error to reference. Bounded because Parakeet doesn't see reference text.</td>
        </tr>
        <tr>
          <td><span class="tag tag-blue">4</span></td>
          <td><strong>Disagree: Reverb matches ref</strong></td>
          <td class="word-ref">wiggle</td>
          <td class="word-match">wiggle</td>
          <td class="word-err">wriggle</td>
          <td><span class="tag tag-blue">keep reverb</span><br>Already correct</td>
          <td style="font-size:0.72rem;color:var(--text-dim)">Low. Reverb already has the reference word. Parakeet's different word is noise.</td>
        </tr>
        <tr>
          <td><span class="tag tag-yellow">5</span></td>
          <td><strong>Disagree: neither matches ref</strong></td>
          <td class="word-ref">wiggle</td>
          <td class="word-err">wiggly</td>
          <td class="word-err">wriggle</td>
          <td><span class="tag tag-yellow">keep reverb</span><br>No clear winner</td>
          <td style="font-size:0.72rem;color:var(--text-dim)">15-25% chance student was correct. Both engines failed on a difficult word. Reverb default is arbitrary but consistent.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- SECTION 4: Probability landscape -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <div class="section-header"><span class="section-num">4</span> Probability Landscape</div>

  <div class="grid-2">
    <div class="card">
      <h2>P(Student Said Word Correctly)</h2>
      <p style="font-size:0.75rem;color:var(--text-dim);margin-bottom:0.75rem">Estimated from base rates + engine agreement patterns. Not empirically calibrated &mdash; validation needed.</p>

      <div class="stat-row">
        <span class="stat-label">Both agree + match ref</span>
        <div class="stat-bar"><div class="stat-fill" style="width:93%;background:var(--green)"></div></div>
        <span class="stat-value" style="color:var(--green)">~93%</span>
      </div>
      <div class="stat-row">
        <span class="stat-label">One matches ref (typical)</span>
        <div class="stat-bar"><div class="stat-fill" style="width:80%;background:var(--cyan)"></div></div>
        <span class="stat-value" style="color:var(--cyan)">~80%</span>
      </div>
      <div class="stat-row">
        <span class="stat-label">One matches ref (struggling)</span>
        <div class="stat-bar"><div class="stat-fill" style="width:70%;background:var(--yellow)"></div></div>
        <span class="stat-value" style="color:var(--yellow)">~70%</span>
      </div>
      <div class="stat-row">
        <span class="stat-label">Neither matches ref</span>
        <div class="stat-bar"><div class="stat-fill" style="width:20%;background:var(--orange)"></div></div>
        <span class="stat-value" style="color:var(--orange)">~20%</span>
      </div>
      <div class="stat-row">
        <span class="stat-label">Both agree on non-ref</span>
        <div class="stat-bar"><div class="stat-fill" style="width:12%;background:var(--red)"></div></div>
        <span class="stat-value" style="color:var(--red)">~12%</span>
      </div>

      <div class="note">
        <strong>Caveat:</strong> These are estimated priors, not measured values.
        The "ROVER literature" derivation claimed in the original proposal is misleading &mdash;
        no such methodology exists. These numbers need empirical calibration.
      </div>
    </div>

    <div class="card">
      <h2>Net Impact on 100-Word Passage</h2>
      <p style="font-size:0.75rem;color:var(--text-dim);margin-bottom:0.75rem">Struggling reader at ~85% accuracy. Estimates are directional, not precise.</p>

      <h3 style="font-size:0.8rem;margin-top:0.5rem">Without Tiebreaker (Status Quo)</h3>
      <div class="cmp">
        <span class="cmp-label">100 words</span>
        <div class="cmp-bars">
          <div class="cmp-bar" style="flex:78;background:var(--green-dim)">78 correct</div>
          <div class="cmp-bar" style="flex:15;background:var(--red-dim)">15 real errors</div>
          <div class="cmp-bar" style="flex:7;background:var(--yellow-dim)">5-10 false errors</div>
        </div>
      </div>
      <div style="font-size:0.72rem;color:var(--text-dim);margin:0.25rem 0 0.75rem 100px">Reported WCPM: <strong>75-80</strong> (deflated by 5-10)</div>

      <h3 style="font-size:0.8rem">With Tiebreaker</h3>
      <div class="cmp">
        <span class="cmp-label">100 words</span>
        <div class="cmp-bars">
          <div class="cmp-bar" style="flex:82;background:var(--green-dim)">82 correct</div>
          <div class="cmp-bar" style="flex:14;background:var(--red-dim)">13-14 real errors</div>
          <div class="cmp-bar" style="flex:2;background:var(--yellow-dim)">1-3 false</div>
          <div class="cmp-bar" style="flex:2;background:var(--purple-dim)">1-2 masked</div>
        </div>
      </div>
      <div style="font-size:0.72rem;color:var(--text-dim);margin:0.25rem 0 0.75rem 100px">Reported WCPM: <strong>83-85</strong> (close to truth)</div>

      <div class="note note-info">
        The tiebreaker trades ~1-2 masked real errors for ~4-8 recovered false errors.
        Net effect: WCPM moves <strong>closer to ground truth</strong>.
        The 3-5 word impact is within the Standard Error of Measurement (8-11 WCPM)
        and within human inter-rater disagreement (3-4 WCPM).
      </div>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- SECTION 5: The Dangerous Case -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <div class="section-header"><span class="section-num">5</span> The Dangerous Case: Autocorrect TO Reference</div>

  <div class="card full-width">
    <p style="font-size:0.82rem;margin-bottom:1rem">
      The tiebreaker can produce a <strong>false negative</strong> (hide a real error) when one engine's language model
      autocorrects the student's wrong word <em>to</em> the reference word. For this to happen, ALL of these must be true:
    </p>

    <div class="grid-3" style="margin-bottom:0">
      <div style="text-align:center">
        <div style="font-size:2rem;margin-bottom:0.25rem">1</div>
        <div style="font-size:0.78rem">Student says wrong word <strong>W</strong><br>(e.g., says "weasel" for "wiggle")</div>
      </div>
      <div style="text-align:center">
        <div style="font-size:2rem;margin-bottom:0.25rem">2</div>
        <div style="font-size:0.78rem">Engine A hears <strong>W</strong> correctly<br>(accurately transcribes the error)</div>
      </div>
      <div style="text-align:center">
        <div style="font-size:2rem;margin-bottom:0.25rem">3</div>
        <div style="font-size:0.78rem">Engine B's LM autocorrects<br><strong>W &rarr; reference</strong><br>(without seeing the reference text)</div>
      </div>
    </div>

    <div class="note note-danger" style="margin-top:1rem">
      <strong>Estimated frequency:</strong> ~15-20% of disagreements (unverified estimate).
      This requires <em>phonetic similarity</em> between the wrong word and the reference,
      AND the reference having higher LM probability. The cross-validator doesn't see the reference text &mdash;
      its LM must independently produce the reference word.
    </div>

    <div class="example-box" style="margin-top:1rem">
      <div class="example-label">Example: False Negative Scenario</div>
      <div style="font-size:0.8rem">
        Reference: <span class="word-ref">"The cat <strong>sat</strong> on the mat"</span><br>
        Student says: "The cat <strong style="color:var(--red)">set</strong> on the mat"<br>
        Reverb hears: "The cat <strong style="color:var(--red)">set</strong> on the mat" <span class="word-dim">(correct transcription of the error)</span><br>
        Parakeet hears: "The cat <strong style="color:var(--cyan)">sat</strong> on the mat" <span class="word-dim">(LM autocorrected "set" &rarr; "sat" because "sat on" is more common)</span><br>
        Tiebreaker: Parakeet matches reference <span class="arrow-r">&rarr;</span> trusts Parakeet <span class="arrow-r">&rarr;</span> <span style="color:var(--red)"><strong>real error masked</strong></span>
      </div>
    </div>

    <div class="example-box">
      <div class="example-label">Mitigation: Why This Is Bounded</div>
      <div style="font-size:0.8rem">
        <strong>1.</strong> Parakeet doesn't see the reference. It can only autocorrect based on LM priors &mdash;
        which requires phonetic similarity between W and the reference word.<br>
        <strong>2.</strong> "set" &rarr; "sat" works because they're phonetically similar AND "sat on" has high LM probability.
        But "weasel" &rarr; "wiggle" would NOT be autocorrected &mdash; too phonetically distant.<br>
        <strong>3.</strong> The adaptive threshold disables the tiebreaker if too many confirmed errors accumulate,
        protecting the most struggling readers.
      </div>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- SECTION 6: Adaptive Safety Threshold -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <div class="section-header"><span class="section-num">6</span> Adaptive Safety Threshold</div>

  <div class="card full-width">
    <p style="font-size:0.82rem;margin-bottom:1rem">
      The tiebreaker works best when most words are correct (high base rate). For severely struggling readers,
      the base rate drops and the risk of masking real errors increases. An adaptive threshold protects against this.
    </p>

    <div class="grid-2" style="margin-bottom:0">
      <div>
        <h3 style="font-size:0.85rem;margin-bottom:0.5rem;color:var(--green)">Tiebreaker Active (Normal)</h3>
        <ul class="bias-list">
          <li><span class="bias-icon" style="color:var(--green)">&#10003;</span> Running confirmed-error rate &lt; 20%</li>
          <li><span class="bias-icon" style="color:var(--green)">&#10003;</span> Student reading at ~80%+ accuracy</li>
          <li><span class="bias-icon" style="color:var(--green)">&#10003;</span> Disagreements resolved by reference match</li>
          <li><span class="bias-icon" style="color:var(--green)">&#10003;</span> Optimal decision under most cost assumptions</li>
        </ul>
      </div>
      <div>
        <h3 style="font-size:0.85rem;margin-bottom:0.5rem;color:var(--purple)">Tiebreaker Disabled (Safety)</h3>
        <ul class="bias-list">
          <li><span class="bias-icon" style="color:var(--red)">!</span> Running confirmed-error rate &ge; 20%</li>
          <li><span class="bias-icon" style="color:var(--red)">!</span> Student reading at frustration level (&lt;80%)</li>
          <li><span class="bias-icon" style="color:var(--red)">!</span> All disagreements default to Reverb</li>
          <li><span class="bias-icon" style="color:var(--yellow)">~</span> More false positives but fewer hidden errors</li>
        </ul>
      </div>
    </div>

    <div class="note" style="margin-top:1rem">
      <strong>Implementation:</strong> Track confirmed errors (both engines agree on non-reference word) as a running counter.
      After 10+ confirmed words, if error rate exceeds 20%, disable tiebreaker for the rest of the passage.
      Threshold requires empirical calibration &mdash; 20% is a reasonable starting point based on the
      Betts (1946) frustration-level criterion and the decision-theoretic analysis showing the tiebreaker
      becomes suboptimal below ~75% accuracy under screening cost assumptions.
    </div>
  </div>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- SECTION 7: Pipeline Position -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <div class="section-header"><span class="section-num">7</span> Where It Fits in the Pipeline</div>

  <div class="card full-width">
    <div style="font-family:monospace;font-size:0.75rem;line-height:1.8;color:var(--text-dim)">
      <div>Audio &rarr; <span style="color:var(--text)">Reverb (v=1.0 + v=0.0)</span></div>
      <div style="padding-left:3rem">&darr;</div>
      <div style="padding-left:1.5rem"><span style="color:var(--text)">Kitchen Sink Pipeline</span> (parallel: Reverb ensemble + Parakeet cross-validation)</div>
      <div style="padding-left:3rem">&darr;</div>
      <div style="padding-left:1.5rem"><span style="color:var(--text)">Sequence Alignment</span> (Reverb v1.0 vs v0.0) &rarr; Disfluency Tagging</div>
      <div style="padding-left:3rem">&darr;</div>
      <div style="padding-left:1.5rem"><span style="color:var(--text)">Cross-Validation</span> (NW align merged Reverb vs Parakeet &rarr; confirmed/disagreed/unconfirmed)</div>
      <div style="padding-left:3rem">&darr;</div>
      <div style="padding-left:1.5rem"><span style="color:var(--text)">Hyphen Splitting</span> (split hyphenated STT words)</div>
      <div style="padding-left:3rem">&darr;</div>
      <div style="padding-left:1.5rem;color:var(--yellow);font-weight:700;border:1px dashed var(--yellow);padding:0.4rem 1rem;border-radius:6px;display:inline-block">
        &#9658; REFERENCE TIEBREAKER (HERE) &mdash; app.js after L616, before L741
      </div>
      <div style="padding-left:3rem">&darr;</div>
      <div style="padding-left:1.5rem"><span style="color:var(--text)">Build sttLookup</span> (canonical word &rarr; STT word map)</div>
      <div style="padding-left:3rem">&darr;</div>
      <div style="padding-left:1.5rem"><span style="color:var(--text)">alignWords()</span> (diff-match-patch: reference vs STT transcript)</div>
      <div style="padding-left:3rem">&darr;</div>
      <div style="padding-left:1.5rem"><span style="color:var(--text)">Post-processing</span> (compounds, omission recovery, near-miss, struggle, diagnostics)</div>
      <div style="padding-left:3rem">&darr;</div>
      <div style="padding-left:1.5rem"><span style="color:var(--text)">UI Rendering</span></div>
    </div>

    <div class="note note-info" style="margin-top:1rem">
      <strong>Why here?</strong> Before <code>sttLookup</code> and <code>alignWords()</code>,
      so corrected words flow naturally through the entire downstream pipeline.
      <code>alignWords()</code> will classify a tiebroken word as "correct" with no special-case code needed.
      All downstream processors (compound merge, struggle detection, forgiveness) see the corrected data.
    </div>
  </div>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- SECTION 8: Research Confidence -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <div class="section-header"><span class="section-num">8</span> Research Confidence Assessment</div>

  <div class="card full-width">
    <table class="scenario-table">
      <thead>
        <tr>
          <th>Claim</th>
          <th>Confidence</th>
          <th>Evidence</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Novel approach (no published multi-engine ORF)</td>
          <td><span class="tag tag-green">High</span></td>
          <td style="font-size:0.72rem">Verified across NAEP, SERDA, CORE, Amira, SoapBox, Lalilo, ClearFluency, CMU LISTEN, ROVER literature</td>
        </tr>
        <tr>
          <td>Defensible from assessment science perspective</td>
          <td><span class="tag tag-green">High</span></td>
          <td style="font-size:0.72rem">ORF is known-text; all published systems use reference text; human scorers use it by definition</td>
        </tr>
        <tr>
          <td>Engine diversity is sufficient for cross-validation</td>
          <td><span class="tag tag-green">High</span></td>
          <td style="font-size:0.72rem">CTC+Attention vs TDT = different architectures = different error patterns (Bayoumi 2025)</td>
        </tr>
        <tr>
          <td>Clinical alignment (self-corrections counted correct)</td>
          <td><span class="tag tag-green">High</span></td>
          <td style="font-size:0.72rem">DIBELS, Acadience, CBM-R, Running Records all count self-corrections as correct</td>
        </tr>
        <tr>
          <td>Tiebreaker optimal under most cost assumptions</td>
          <td><span class="tag tag-blue">Medium-High</span></td>
          <td style="font-size:0.72rem">Decision theory analysis: optimal for accuracy &gt;~70% under symmetric cost ratios</td>
        </tr>
        <tr>
          <td>Net WCPM improvement from tiebreaker</td>
          <td><span class="tag tag-yellow">Medium</span></td>
          <td style="font-size:0.72rem">Directionally sound but depends on 4 uncertain parameters; needs empirical validation</td>
        </tr>
        <tr>
          <td>Prior probability estimates</td>
          <td><span class="tag tag-yellow">Low-Medium</span></td>
          <td style="font-size:0.72rem">Reasonable estimates, NOT from ROVER literature as originally claimed; need calibration</td>
        </tr>
        <tr>
          <td>15-20% autocorrect-to-reference rate</td>
          <td><span class="tag tag-red">Low</span></td>
          <td style="font-size:0.72rem">Plausible order of magnitude but no direct measurement exists anywhere in the literature</td>
        </tr>
        <tr>
          <td>85%+ accuracy even for struggling readers</td>
          <td><span class="tag tag-red">Overstated</span></td>
          <td style="font-size:0.72rem">NAEP below-basic-low: 82%. Frustration level: &lt;90%. Some may be below 80%.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div style="text-align:center;color:var(--text-dim);font-size:0.7rem;margin-top:2rem;padding-top:1rem;border-top:1px solid var(--border)">
    Generated 2026-02-08 &middot; Based on research from 7 parallel investigation teams &middot;
    25+ papers reviewed &middot; All claims independently verified where possible
  </div>

</div>
</body>
</html>
